{% extends "adoptions/plantilla.html" %}
{% load static %}

{% block contenido %}

<div class="container mt-4 mb-5">
  <h2 class="text-center mb-4 text-success fw-bold"> Informaci贸n de la mascota</h2>

  <!-- Informaci贸n de la mascota -->
  <div class="card shadow-sm p-4 mb-4">
    <h4 class="mb-3 text-primary">{{ pet.name }}</h4>
    <div class="row mb-2">
      <div class="col-md-6"><strong>Edad:</strong> {{ pet.age }} a帽os</div>
      <div class="col-md-6"><strong>Raza:</strong> {{ pet.breed }}</div>
    </div>

     <div class="row mb-2">
      <div class="col-md-6"><strong>Descripcion:</strong> {{ pet.description}}</div>
      <div class="col-md-6"><strong>Color:</strong> {{ pet.color }}</div>
    </div>
  </div>

  <!-- Fotos -->
  <div class="mb-4">
    <h5 class="text-secondary mb-3">Fotos</h5>
    <div class="d-flex flex-wrap gap-3">
      {% for photo in photos %}
        <img src="{{ photo.image_path.url }}" alt="Foto de {{ pet.name }}" class="rounded border" style="width:200px; height:200px; object-fit:cover;">
      {% empty %}
        <p class="text-muted">No hay fotos disponibles para esta mascota.</p>
      {% endfor %}
    </div>
  </div>

  <!-- Formulario de adopci贸n -->
  <div class="card shadow-sm p-4">
    <h4 class="mb-3 text-success">Formulario de Adopci贸n</h4>

    <!-- Informaci贸n del adoptante -->
    <h5 class="mb-3 text-primary">Informaci贸n del adoptante</h5>
    <div class="row mb-3">
      <div class="col-md-6">
        <label class="form-label fw-semibold">Nombres</label>
        <input type="text" class="form-control" readonly value="{{ user.first_name }}">
      </div>
      <div class="col-md-6">
        <label class="form-label fw-semibold">Apellidos</label>
        <input type="text" class="form-control" readonly value="{{ user.last_name }}">
      </div>
    </div>
    <div class="row mb-3">
      <div class="col-md-6">
        <label class="form-label fw-semibold"># Contacto</label>
        <input type="text" class="form-control" readonly value="{{ user.phone }}">
      </div>
      <div class="col-md-6">
        <label class="form-label fw-semibold">Direcci贸n</label>
        <input type="text" class="form-control" readonly value="{{ user.address }}">
      </div>
    </div>

    <!-- Contrato de adopci贸n -->
    <h5 class="mb-3 text-primary">Contrato de Adopci贸n</h5>
    <small class="text-muted d-block mb-2">*Descargue el siguiente PDF, ll茅nelo y luego s煤balo aqu铆*</small>
    <a href="{% static 'plantilla/adoptions/contrato.pdf' %}" class="btn btn-outline-primary" download>
        Descargar contrato de adopci贸n
    </a>


    <!-- Subir contrato -->
    <form action="/saveAdoption" method="POST" enctype="multipart/form-data" id="frm_adoption">
      {% csrf_token %}
      <input type="hidden" name="pet" value="{{ pet.id }}">
      <div class="mb-3">
        <label for="contract" class="form-label fw-semibold">Subir contrato firmado (PDF)</label>
        <input type="file" name="contract" id="contract" class="form-control" accept="application/pdf" required>
      </div>
      <div class="text-center">
        <button type="submit" class="btn btn-success px-4"><i class="bi bi-check-circle"></i> Enviar</button>
      </div>
    </form>
  </div>
</div>

<!-- Script para validaci贸n de archivo PDF -->

<script>
  $("#contract").fileinput({
    language: "es",
    allowedFileExtensions: ["pdf"],
    showCaption: false,
    dropZoneEnabled: true,
    showClose: false,
    maxFileCount: 1,
    browseClass: "btn btn-primary",
  });
</script>

<script>
  $(document).ready(function() {
    $("#frm_adoption").validate({
      rules: {
        contract: {
          required: true,
          extension: "pdf"
        }
      },
      messages: {
        contract: {
          required: "Debe subir el contrato firmado",
          extension: "Solo se permite un archivo PDF"
        }
      }
    });
  });
</script>

{% endblock %}
